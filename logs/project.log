2025-08-22 11:28:29,439 - GHGERC_BUS_PROJECT - INFO - ===== 🚌 Bus CO2 Reduction Calculation Pipeline Start =====
2025-08-22 11:28:30,579 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 11:28:30,579 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 00_edit_db.py
2025-08-22 11:28:30,580 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 11:28:44,716 - GHGERC_BUS_PROJECT - INFO - --- Output from 00_edit_db.py ---
--- [파일 00] 데이터베이스 스키마 관리 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!

--- 기존 테이블 삭제 및 새 테이블 생성 시작 ---
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 'bus_vehicle_master' 테이블 생성 성공적으로 실행되었습니다.
✅ 'bus_driving_records' 테이블 생성 성공적으로 실행되었습니다.
✅ 'bus_baseline_parameters' 테이블 생성 성공적으로 실행되었습니다.
✅ 'bus_emission_reductions' 테이블 생성 성공적으로 실행되었습니다.
--- 기존 테이블 삭제 및 새 테이블 생성 완료 ---

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 11:28:44,716 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '00_edit_db.py' finished successfully.
2025-08-22 11:28:44,717 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 11:28:44,717 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 01_insert_monthly_data.py
2025-08-22 11:28:44,717 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 11:28:56,040 - GHGERC_BUS_PROJECT - INFO - --- Output from 01_insert_monthly_data.py ---
--- [파일 1] 월별 운행 기록 데이터 생성 및 DB 적재 시작 ---
✅ 가상 데이터 생성 및 정제를 완료했습니다.
✅ 생성된 데이터를 엑셀 파일로 저장했습니다: generated_data\generated_bus_data_20250822_112847.xlsx
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ 'bus_vehicle_master' 테이블에 차량 마스터 데이터를 저장/업데이트합니다...
✅ 40개의 차량 마스터 레코드가 성공적으로 저장/업데이트되었습니다.
⏳ 'bus_driving_records' 테이블에 월별 데이터를 저장/업데이트합니다...
✅ 64개의 월별 운행 기록 레코드가 성공적으로 저장/업데이트되었습니다.
⏳ 'bus_monthly_fuel_data' 테이블에 월별 연료 데이터를 저장/업데이트합니다...
✅ 64개의 월별 연료 기록 레코드가 성공적으로 삽입/업데이트되었습니다.

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 11:28:56,040 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '01_insert_monthly_data.py' finished successfully.
2025-08-22 11:28:56,040 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 11:28:56,040 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 02_calculate_baseline.py
2025-08-22 11:28:56,040 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 11:29:05,042 - GHGERC_BUS_PROJECT - INFO - --- Output from 02_calculate_baseline.py ---
--- [파일 2] 베이스라인 인자 계산 및 DB 적재 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ 'bus_monthly_fuel_data' 테이블에서 데이터를 로드합니다...
✅ 2634개의 'bus_monthly_fuel_data' 데이터를 성공적으로 로드했습니다.
⏳ 'bus_vehicle_master' 테이블에서 데이터를 로드합니다...
✅ 40개의 'bus_vehicle_master' 데이터를 성공적으로 로드했습니다.
✅ 베이스라인 계산 대상 내연기관 차량 31대에 대한 데이터 1278개를 로드했습니다.
⚠️ 차량 서울74사1358: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사1600: 베이스라인 계산에 필요한 최소 3년(36개월)치 데이터가 부족합니다 (35개월). 베이스라인을 계산하지 않습니다.
⚠️ 차량 서울74사1836: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사2130: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사3966: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사4382: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사4402: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사5448: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사5731: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사6298: 베이스라인 계산에 필요한 최소 3년(36개월)치 데이터가 부족합니다 (33개월). 베이스라인을 계산하지 않습니다.
⚠️ 차량 서울74사7164: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사8960: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
✅ 베이스라인 인자 계산을 완료했습니다.
⏳ 'bus_baseline_parameters' 테이블에 데이터를 저장/업데이트합니다...
❌ 베이스라인 데이터 저장 오류: column "baseline_co2_emission_kg" of relation "bus_baseline_parameters" does not exist
LINE 2: ...distance_km", "avg_annual_fuel_l", "fuel_per_km", "baseline_...
                                                             ^


✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 11:29:05,044 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '02_calculate_baseline.py' finished successfully.
2025-08-22 11:29:05,044 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 11:29:05,044 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 04_calculate_business_target.py
2025-08-22 11:29:05,044 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 11:29:06,812 - GHGERC_BUS_PROJECT - INFO - --- Output from 04_calculate_business_target.py ---
--- [파일 4] 사업 목표 감축량 계산 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ 	'bus_baseline_parameters' 테이블에서 데이터를 로드합니다...
✅ 0개의 	'bus_baseline_parameters' 데이터를 성공적으로 로드했습니다.
⏳ 	'bus_vehicle_master' 테이블에서 데이터를 로드합니다...
✅ 40개의 	'bus_vehicle_master' 데이터를 성공적으로 로드했습니다.
⚠️ 필요한 데이터(베이스라인 또는 차량 마스터)가 없습니다. 01, 02번 스크립트를 먼저 실행해주세요.
2025-08-22 11:29:06,813 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '04_calculate_business_target.py' finished successfully.
2025-08-22 11:29:06,813 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 11:29:06,813 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 05_co2_reduction_calc.py
2025-08-22 11:29:06,814 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 11:29:09,820 - GHGERC_BUS_PROJECT - INFO - --- Output from 05_co2_reduction_calc.py ---
--- [파일 5] 상세 CO2 감축량 계산 시작 (엑셀 로직 기반) ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ 감축량 계산을 위해 'bus_baseline_parameters'와 'bus_vehicle_master' 테이블에서 데이터를 로드합니다...
❌ 데이터 로드 중 오류 발생: Execution failed on sql '
        SELECT
            vm.vehicle_plate_no,
            vm.business_type,
            vm.ev_registration_date,
            vm.original_fuel_type,
            bp.avg_annual_fuel_l, -- 베이스라인 연간 연료 소비량
            bp.baseline_co2_emission_kg, -- 베이스라인 CO2 배출량 (02_calculate_baseline.py에서 계산됨)
            bp.baseline_emission_factor, -- 베이스라인 배출계수 (02_calculate_baseline.py에서 계산됨)
            bmfd.distance_km AS ev_latest_month_distance_km -- 전기차의 최신 월별 주행 거리
        FROM
            bus_vehicle_master vm
        JOIN
            bus_baseline_parameters bp ON vm.original_ice_plate_no = bp.vehicle_plate_no -- 대체된 내연기관 차량의 베이스라인 조인
        LEFT JOIN LATERAL (
            SELECT
                bmfd_sub.distance_km,
                bmfd_sub.record_year_month
            FROM
                bus_monthly_fuel_data bmfd_sub
            WHERE
                bmfd_sub.vehicle_plate_no = vm.vehicle_plate_no
            ORDER BY
                bmfd_sub.record_year_month DESC
            LIMIT 1
        ) AS bmfd ON vm.vehicle_plate_no IS NOT NULL -- 전기차량에 대해서만 조인 시도
        WHERE
            vm.ev_registration_date IS NOT NULL
            AND vm.business_type = '대체도입';
        ': column bp.baseline_co2_emission_kg does not exist
LINE 8:             bp.baseline_co2_emission_kg, -- 베이스라인 CO2 ...
                    ^


✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 11:29:09,821 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '05_co2_reduction_calc.py' finished successfully.
2025-08-22 11:29:09,821 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 11:29:09,822 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 03_display_baseline.py
2025-08-22 11:29:09,822 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 11:29:13,953 - GHGERC_BUS_PROJECT - INFO - --- Output from 03_display_baseline.py ---
--- [파일 3] 베이스라인 인자 조회 및 출력 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!

⏳ 베이스라인 인자 및 차량 마스터 데이터를 조회합니다...
⏳ 'bus_baseline_parameters' 테이블에서 데이터를 로드합니다...
✅ 0개의 'bus_baseline_parameters' 데이터를 성공적으로 로드했습니다.
⏳ 'bus_vehicle_master' 테이블에서 데이터를 로드합니다...
✅ 40개의 'bus_vehicle_master' 데이터를 성공적으로 로드했습니다.
⚠️ 조회된 데이터가 없습니다. 01, 02번 스크립트를 먼저 실행했는지 확인해주세요.

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 11:29:13,953 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '03_display_baseline.py' finished successfully.
2025-08-22 11:29:13,953 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 11:29:13,953 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 06_Report.py
2025-08-22 11:29:13,953 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 11:29:19,351 - GHGERC_BUS_PROJECT - INFO - --- Output from 06_Report.py ---
--- [파일 6] 종합 분석 보고서(Excel) 생성 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ [1/3] 종합 보고서 데이터를 로드합니다...
⏳ [2/3] 월별 운행기록 데이터를 로드합니다...
⏳ [3/3] 베이스라인 계산결과 데이터를 로드합니다...

⏳ 생성된 보고서를 Excel 파일로 저장합니다: reports\bus_analysis_report_20250822_112919.xlsx
✅ 보고서 저장이 완료되었습니다: reports\bus_analysis_report_20250822_112919.xlsx

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 11:29:19,352 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '06_Report.py' finished successfully.
2025-08-22 11:29:19,352 - GHGERC_BUS_PROJECT - INFO - 🎉🎉🎉 All scripts executed successfully! Pipeline finished. 🎉🎉🎉
2025-08-22 12:03:17,332 - GHGERC_BUS_PROJECT - INFO - ===== 🚌 Bus CO2 Reduction Calculation Pipeline Start =====
2025-08-22 12:03:18,787 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 12:03:18,788 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 00_edit_db.py
2025-08-22 12:03:18,788 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 12:03:21,085 - GHGERC_BUS_PROJECT - INFO - --- Output from 00_edit_db.py ---
--- [파일 00] 데이터베이스 스키마 관리 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!

--- 기존 테이블 삭제 및 새 테이블 생성 시작 ---
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 'bus_vehicle_master' 테이블 생성 성공적으로 실행되었습니다.
✅ 'bus_driving_records' 테이블 생성 성공적으로 실행되었습니다.
✅ 'bus_baseline_parameters' 테이블 생성 성공적으로 실행되었습니다.
✅ 'bus_emission_reductions' 테이블 생성 성공적으로 실행되었습니다.
--- 기존 테이블 삭제 및 새 테이블 생성 완료 ---

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 12:03:21,085 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '00_edit_db.py' finished successfully.
2025-08-22 12:03:21,086 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 12:03:21,086 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 01_insert_monthly_data.py
2025-08-22 12:03:21,086 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 12:03:24,162 - GHGERC_BUS_PROJECT - INFO - --- Output from 01_insert_monthly_data.py ---
--- [파일 1] 월별 운행 기록 데이터 생성 및 DB 적재 시작 ---
✅ 가상 데이터 생성 및 정제를 완료했습니다.
✅ 생성된 데이터를 엑셀 파일로 저장했습니다: generated_data\generated_bus_data_20250822_120322.xlsx
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ 'bus_vehicle_master' 테이블에 차량 마스터 데이터를 저장/업데이트합니다...
✅ 40개의 차량 마스터 레코드가 성공적으로 저장/업데이트되었습니다.
⏳ 'bus_driving_records' 테이블에 월별 데이터를 저장/업데이트합니다...
✅ 94개의 월별 운행 기록 레코드가 성공적으로 저장/업데이트되었습니다.
⏳ 'bus_monthly_fuel_data' 테이블에 월별 연료 데이터를 저장/업데이트합니다...
✅ 94개의 월별 연료 기록 레코드가 성공적으로 삽입/업데이트되었습니다.

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 12:03:24,163 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '01_insert_monthly_data.py' finished successfully.
2025-08-22 12:03:24,163 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 12:03:24,164 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 02_calculate_baseline.py
2025-08-22 12:03:24,164 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 12:03:25,181 - GHGERC_BUS_PROJECT - INFO - --- Output from 02_calculate_baseline.py ---
--- [파일 2] 베이스라인 인자 계산 및 DB 적재 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ 'bus_monthly_fuel_data' 테이블에서 데이터를 로드합니다...
✅ 3928개의 'bus_monthly_fuel_data' 데이터를 성공적으로 로드했습니다.
⏳ 'bus_vehicle_master' 테이블에서 데이터를 로드합니다...
✅ 40개의 'bus_vehicle_master' 데이터를 성공적으로 로드했습니다.
✅ 베이스라인 계산 대상 내연기관 차량 30대에 대한 데이터 1206개를 로드했습니다.
⚠️ 차량 서울74사1547: 베이스라인 계산에 필요한 최소 3년(36개월)치 데이터가 부족합니다 (34개월). 베이스라인을 계산하지 않습니다.
⚠️ 차량 서울74사2248: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사2334: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사2453: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사4171: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사4480: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사5676: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사6207: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사8211: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사9678: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사9819: 베이스라인 계산에 필요한 최소 3년(36개월)치 데이터가 부족합니다 (32개월). 베이스라인을 계산하지 않습니다.
⚠️ 차량 서울74사9922: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
✅ 베이스라인 인자 계산을 완료했습니다.
⏳ 'bus_baseline_parameters' 테이블에 데이터를 저장/업데이트합니다...
❌ 베이스라인 데이터 저장 오류: column "baseline_co2_emission_kg" of relation "bus_baseline_parameters" does not exist
LINE 2: ...distance_km", "avg_annual_fuel_l", "fuel_per_km", "baseline_...
                                                             ^


✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 12:03:25,182 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '02_calculate_baseline.py' finished successfully.
2025-08-22 12:03:25,183 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 12:03:25,183 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 04_calculate_business_target.py
2025-08-22 12:03:25,183 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 12:03:26,145 - GHGERC_BUS_PROJECT - INFO - --- Output from 04_calculate_business_target.py ---
--- [파일 4] 사업 목표 감축량 계산 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ 	'bus_baseline_parameters' 테이블에서 데이터를 로드합니다...
✅ 0개의 	'bus_baseline_parameters' 데이터를 성공적으로 로드했습니다.
⏳ 	'bus_vehicle_master' 테이블에서 데이터를 로드합니다...
✅ 40개의 	'bus_vehicle_master' 데이터를 성공적으로 로드했습니다.
⚠️ 필요한 데이터(베이스라인 또는 차량 마스터)가 없습니다. 01, 02번 스크립트를 먼저 실행해주세요.
2025-08-22 12:03:26,146 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '04_calculate_business_target.py' finished successfully.
2025-08-22 12:03:26,146 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 12:03:26,146 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 05_co2_reduction_calc.py
2025-08-22 12:03:26,146 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 12:03:26,974 - GHGERC_BUS_PROJECT - INFO - --- Output from 05_co2_reduction_calc.py ---
--- [파일 5] 상세 CO2 감축량 계산 시작 (엑셀 로직 기반) ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ 감축량 계산을 위해 'bus_baseline_parameters'와 'bus_vehicle_master' 테이블에서 데이터를 로드합니다...
❌ 데이터 로드 중 오류 발생: Execution failed on sql '
        SELECT
            vm.vehicle_plate_no,
            vm.business_type,
            vm.ev_registration_date,
            vm.original_fuel_type,
            bp.avg_annual_fuel_l, -- 베이스라인 연간 연료 소비량
            bp.baseline_co2_emission_kg, -- 베이스라인 CO2 배출량 (02_calculate_baseline.py에서 계산됨)
            bp.baseline_emission_factor, -- 베이스라인 배출계수 (02_calculate_baseline.py에서 계산됨)
            bmfd.distance_km AS ev_latest_month_distance_km -- 전기차의 최신 월별 주행 거리
        FROM
            bus_vehicle_master vm
        JOIN
            bus_baseline_parameters bp ON vm.original_ice_plate_no = bp.vehicle_plate_no -- 대체된 내연기관 차량의 베이스라인 조인
        LEFT JOIN LATERAL (
            SELECT
                bmfd_sub.distance_km,
                bmfd_sub.record_year_month
            FROM
                bus_monthly_fuel_data bmfd_sub
            WHERE
                bmfd_sub.vehicle_plate_no = vm.vehicle_plate_no
            ORDER BY
                bmfd_sub.record_year_month DESC
            LIMIT 1
        ) AS bmfd ON vm.vehicle_plate_no IS NOT NULL -- 전기차량에 대해서만 조인 시도
        WHERE
            vm.ev_registration_date IS NOT NULL
            AND vm.business_type = '대체도입';
        ': column bp.baseline_co2_emission_kg does not exist
LINE 8:             bp.baseline_co2_emission_kg, -- 베이스라인 CO2 ...
                    ^


✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 12:03:26,975 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '05_co2_reduction_calc.py' finished successfully.
2025-08-22 12:03:26,975 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 12:03:26,976 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 03_display_baseline.py
2025-08-22 12:03:26,976 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 12:03:27,766 - GHGERC_BUS_PROJECT - INFO - --- Output from 03_display_baseline.py ---
--- [파일 3] 베이스라인 인자 조회 및 출력 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!

⏳ 베이스라인 인자 및 차량 마스터 데이터를 조회합니다...
⏳ 'bus_baseline_parameters' 테이블에서 데이터를 로드합니다...
✅ 0개의 'bus_baseline_parameters' 데이터를 성공적으로 로드했습니다.
⏳ 'bus_vehicle_master' 테이블에서 데이터를 로드합니다...
✅ 40개의 'bus_vehicle_master' 데이터를 성공적으로 로드했습니다.
⚠️ 조회된 데이터가 없습니다. 01, 02번 스크립트를 먼저 실행했는지 확인해주세요.

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 12:03:27,767 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '03_display_baseline.py' finished successfully.
2025-08-22 12:03:27,767 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 12:03:27,767 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 06_Report.py
2025-08-22 12:03:27,768 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 12:03:28,884 - GHGERC_BUS_PROJECT - INFO - --- Output from 06_Report.py ---
--- [파일 6] 종합 분석 보고서(Excel) 생성 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ [1/3] 종합 보고서 데이터를 로드합니다...
⏳ [2/3] 월별 운행기록 데이터를 로드합니다...
⏳ [3/3] 베이스라인 계산결과 데이터를 로드합니다...

⏳ 생성된 보고서를 Excel 파일로 저장합니다: reports\bus_analysis_report_20250822_120328.xlsx
✅ 보고서 저장이 완료되었습니다: reports\bus_analysis_report_20250822_120328.xlsx

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 12:03:28,884 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '06_Report.py' finished successfully.
2025-08-22 12:03:28,884 - GHGERC_BUS_PROJECT - INFO - 🎉🎉🎉 All scripts executed successfully! Pipeline finished. 🎉🎉🎉
2025-08-22 12:04:39,586 - GHGERC_BUS_PROJECT - INFO - ===== 🚌 Bus CO2 Reduction Calculation Pipeline Start =====
2025-08-22 12:04:41,271 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 12:04:41,271 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 00_edit_db.py
2025-08-22 12:04:41,272 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 12:04:43,888 - GHGERC_BUS_PROJECT - INFO - --- Output from 00_edit_db.py ---
--- [파일 00] 데이터베이스 스키마 관리 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!

--- 기존 테이블 삭제 및 새 테이블 생성 시작 ---
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 'bus_vehicle_master' 테이블 생성 성공적으로 실행되었습니다.
✅ 'bus_driving_records' 테이블 생성 성공적으로 실행되었습니다.
✅ 'bus_baseline_parameters' 테이블 생성 성공적으로 실행되었습니다.
✅ 'bus_emission_reductions' 테이블 생성 성공적으로 실행되었습니다.
--- 기존 테이블 삭제 및 새 테이블 생성 완료 ---

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 12:04:43,890 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '00_edit_db.py' finished successfully.
2025-08-22 12:04:43,891 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 12:04:43,891 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 01_insert_monthly_data.py
2025-08-22 12:04:43,891 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 12:04:46,721 - GHGERC_BUS_PROJECT - INFO - --- Output from 01_insert_monthly_data.py ---
--- [파일 1] 월별 운행 기록 데이터 생성 및 DB 적재 시작 ---
✅ 가상 데이터 생성 및 정제를 완료했습니다.
✅ 생성된 데이터를 엑셀 파일로 저장했습니다: generated_data\generated_bus_data_20250822_120445.xlsx
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ 'bus_vehicle_master' 테이블에 차량 마스터 데이터를 저장/업데이트합니다...
✅ 40개의 차량 마스터 레코드가 성공적으로 저장/업데이트되었습니다.
⏳ 'bus_driving_records' 테이블에 월별 데이터를 저장/업데이트합니다...
✅ 6개의 월별 운행 기록 레코드가 성공적으로 저장/업데이트되었습니다.
⏳ 'bus_monthly_fuel_data' 테이블에 월별 연료 데이터를 저장/업데이트합니다...
✅ 6개의 월별 연료 기록 레코드가 성공적으로 삽입/업데이트되었습니다.

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 12:04:46,722 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '01_insert_monthly_data.py' finished successfully.
2025-08-22 12:04:46,723 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 12:04:46,723 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 02_calculate_baseline.py
2025-08-22 12:04:46,723 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 12:04:47,870 - GHGERC_BUS_PROJECT - INFO - --- Output from 02_calculate_baseline.py ---
--- [파일 2] 베이스라인 인자 계산 및 DB 적재 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ 'bus_monthly_fuel_data' 테이블에서 데이터를 로드합니다...
✅ 5134개의 'bus_monthly_fuel_data' 데이터를 성공적으로 로드했습니다.
⏳ 'bus_vehicle_master' 테이블에서 데이터를 로드합니다...
✅ 40개의 'bus_vehicle_master' 데이터를 성공적으로 로드했습니다.
✅ 베이스라인 계산 대상 내연기관 차량 27대에 대한 데이터 1059개를 로드했습니다.
⚠️ 차량 서울74사1033: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사1386: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사2961: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사3342: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사3424: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사4091: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사6600: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사8782: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사9105: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사9187: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
✅ 베이스라인 인자 계산을 완료했습니다.
⏳ 'bus_baseline_parameters' 테이블에 데이터를 저장/업데이트합니다...
❌ 베이스라인 데이터 저장 오류: column "baseline_co2_emission_kg" of relation "bus_baseline_parameters" does not exist
LINE 2: ...distance_km", "avg_annual_fuel_l", "fuel_per_km", "baseline_...
                                                             ^


✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 12:04:47,871 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '02_calculate_baseline.py' finished successfully.
2025-08-22 12:04:47,871 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 12:04:47,871 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 04_calculate_business_target.py
2025-08-22 12:04:47,871 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 12:04:48,840 - GHGERC_BUS_PROJECT - INFO - --- Output from 04_calculate_business_target.py ---
--- [파일 4] 사업 목표 감축량 계산 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ 	'bus_baseline_parameters' 테이블에서 데이터를 로드합니다...
✅ 0개의 	'bus_baseline_parameters' 데이터를 성공적으로 로드했습니다.
⏳ 	'bus_vehicle_master' 테이블에서 데이터를 로드합니다...
✅ 40개의 	'bus_vehicle_master' 데이터를 성공적으로 로드했습니다.
⚠️ 필요한 데이터(베이스라인 또는 차량 마스터)가 없습니다. 01, 02번 스크립트를 먼저 실행해주세요.
2025-08-22 12:04:48,841 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '04_calculate_business_target.py' finished successfully.
2025-08-22 12:04:48,842 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 12:04:48,842 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 05_co2_reduction_calc.py
2025-08-22 12:04:48,842 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 12:04:49,582 - GHGERC_BUS_PROJECT - INFO - --- Output from 05_co2_reduction_calc.py ---
--- [파일 5] 상세 CO2 감축량 계산 시작 (엑셀 로직 기반) ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ 감축량 계산을 위해 'bus_baseline_parameters'와 'bus_vehicle_master' 테이블에서 데이터를 로드합니다...
⚠️ 상세 감축량 계산 대상(CNG, 경유 대체도입 전기버스)이 없습니다.

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 12:04:49,582 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '05_co2_reduction_calc.py' finished successfully.
2025-08-22 12:04:49,582 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 12:04:49,583 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 03_display_baseline.py
2025-08-22 12:04:49,583 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 12:04:50,274 - GHGERC_BUS_PROJECT - INFO - --- Output from 03_display_baseline.py ---
--- [파일 3] 베이스라인 인자 조회 및 출력 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!

⏳ 베이스라인 인자 및 차량 마스터 데이터를 조회합니다...
⏳ 'bus_baseline_parameters' 테이블에서 데이터를 로드합니다...
✅ 0개의 'bus_baseline_parameters' 데이터를 성공적으로 로드했습니다.
⏳ 'bus_vehicle_master' 테이블에서 데이터를 로드합니다...
✅ 40개의 'bus_vehicle_master' 데이터를 성공적으로 로드했습니다.
⚠️ 조회된 데이터가 없습니다. 01, 02번 스크립트를 먼저 실행했는지 확인해주세요.

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 12:04:50,274 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '03_display_baseline.py' finished successfully.
2025-08-22 12:04:50,274 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 12:04:50,275 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 06_Report.py
2025-08-22 12:04:50,275 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 12:04:51,373 - GHGERC_BUS_PROJECT - INFO - --- Output from 06_Report.py ---
--- [파일 6] 종합 분석 보고서(Excel) 생성 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ [1/3] 종합 보고서 데이터를 로드합니다...
⏳ [2/3] 월별 운행기록 데이터를 로드합니다...
⏳ [3/3] 베이스라인 계산결과 데이터를 로드합니다...

⏳ 생성된 보고서를 Excel 파일로 저장합니다: reports\bus_analysis_report_20250822_120451.xlsx
✅ 보고서 저장이 완료되었습니다: reports\bus_analysis_report_20250822_120451.xlsx

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 12:04:51,373 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '06_Report.py' finished successfully.
2025-08-22 12:04:51,373 - GHGERC_BUS_PROJECT - INFO - 🎉🎉🎉 All scripts executed successfully! Pipeline finished. 🎉🎉🎉
2025-08-22 13:54:40,979 - GHGERC_BUS_PROJECT - INFO - ===== 🚌 Bus CO2 Reduction Calculation Pipeline Start =====
2025-08-22 13:54:42,326 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 13:54:42,327 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 00_edit_db.py
2025-08-22 13:54:42,327 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 13:54:45,204 - GHGERC_BUS_PROJECT - INFO - --- Output from 00_edit_db.py ---
--- [파일 00] 데이터베이스 스키마 관리 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!

--- 기존 테이블 삭제 및 새 테이블 생성 시작 ---
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 'bus_vehicle_master' 테이블 생성 성공적으로 실행되었습니다.
✅ 'bus_driving_records' 테이블 생성 성공적으로 실행되었습니다.
✅ 'bus_baseline_parameters' 테이블 생성 성공적으로 실행되었습니다.
✅ 'bus_emission_reductions' 테이블 생성 성공적으로 실행되었습니다.
--- 기존 테이블 삭제 및 새 테이블 생성 완료 ---

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 13:54:45,204 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '00_edit_db.py' finished successfully.
2025-08-22 13:54:45,205 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 13:54:45,205 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 01_insert_monthly_data.py
2025-08-22 13:54:45,205 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 13:54:47,440 - GHGERC_BUS_PROJECT - INFO - --- Output from 01_insert_monthly_data.py ---
--- [파일 1] 월별 운행 기록 데이터 생성 및 DB 적재 시작 ---
✅ 가상 데이터 생성 및 정제를 완료했습니다.
✅ 생성된 데이터를 엑셀 파일로 저장했습니다: generated_data\generated_bus_data_20250822_135446.xlsx
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ 'bus_vehicle_master' 테이블에 차량 마스터 데이터를 저장/업데이트합니다...
✅ 40개의 차량 마스터 레코드가 성공적으로 저장/업데이트되었습니다.
⏳ 'bus_driving_records' 테이블에 월별 데이터를 저장/업데이트합니다...
✅ 63개의 월별 운행 기록 레코드가 성공적으로 저장/업데이트되었습니다.
⏳ 'bus_monthly_fuel_data' 테이블에 월별 연료 데이터를 저장/업데이트합니다...
✅ 63개의 월별 연료 기록 레코드가 성공적으로 삽입/업데이트되었습니다.

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 13:54:47,441 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '01_insert_monthly_data.py' finished successfully.
2025-08-22 13:54:47,441 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 13:54:47,441 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 02_calculate_baseline.py
2025-08-22 13:54:47,441 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 13:54:48,226 - GHGERC_BUS_PROJECT - INFO - --- Output from 02_calculate_baseline.py ---
--- [파일 2] 베이스라인 인자 계산 및 DB 적재 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ 'bus_monthly_fuel_data' 테이블에서 데이터를 로드합니다...
✅ 6497개의 'bus_monthly_fuel_data' 데이터를 성공적으로 로드했습니다.
⏳ 'bus_vehicle_master' 테이블에서 데이터를 로드합니다...
✅ 40개의 'bus_vehicle_master' 데이터를 성공적으로 로드했습니다.
✅ 베이스라인 계산 대상 내연기관 차량 32대에 대한 데이터 1293개를 로드했습니다.
⚠️ 차량 서울74사1168: 베이스라인 계산에 필요한 최소 3년(36개월)치 데이터가 부족합니다 (35개월). 베이스라인을 계산하지 않습니다.
⚠️ 차량 서울74사1596: 베이스라인 계산에 필요한 최소 3년(36개월)치 데이터가 부족합니다 (35개월). 베이스라인을 계산하지 않습니다.
⚠️ 차량 서울74사2371: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사4299: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사6024: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사6924: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사6977: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사6987: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사8066: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사8280: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사8590: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사9170: 베이스라인 계산에 필요한 최소 3년(36개월)치 데이터가 부족합니다 (33개월). 베이스라인을 계산하지 않습니다.
⚠️ 차량 서울74사9299: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
✅ 베이스라인 인자 계산을 완료했습니다.
⏳ 'bus_baseline_parameters' 테이블에 데이터를 저장/업데이트합니다...
❌ 베이스라인 데이터 저장 오류: column "baseline_co2_emission_kg" of relation "bus_baseline_parameters" does not exist
LINE 2: ...distance_km", "avg_annual_fuel_l", "fuel_per_km", "baseline_...
                                                             ^


✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 13:54:48,227 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '02_calculate_baseline.py' finished successfully.
2025-08-22 13:54:48,227 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 13:54:48,227 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 04_calculate_business_target.py
2025-08-22 13:54:48,227 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 13:54:48,809 - GHGERC_BUS_PROJECT - INFO - --- Output from 04_calculate_business_target.py ---
--- [파일 4] 사업 목표 감축량 계산 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ 	'bus_baseline_parameters' 테이블에서 데이터를 로드합니다...
✅ 0개의 	'bus_baseline_parameters' 데이터를 성공적으로 로드했습니다.
⏳ 	'bus_vehicle_master' 테이블에서 데이터를 로드합니다...
✅ 40개의 	'bus_vehicle_master' 데이터를 성공적으로 로드했습니다.
⚠️ 필요한 데이터(베이스라인 또는 차량 마스터)가 없습니다. 01, 02번 스크립트를 먼저 실행해주세요.
2025-08-22 13:54:48,809 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '04_calculate_business_target.py' finished successfully.
2025-08-22 13:54:48,809 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 13:54:48,809 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 05_co2_reduction_calc.py
2025-08-22 13:54:48,810 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 13:54:49,461 - GHGERC_BUS_PROJECT - INFO - --- Output from 05_co2_reduction_calc.py ---
--- [파일 5] 상세 CO2 감축량 계산 시작 (엑셀 로직 기반) ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ 감축량 계산을 위해 'bus_baseline_parameters'와 'bus_vehicle_master' 테이블에서 데이터를 로드합니다...
⚠️ 상세 감축량 계산 대상(CNG, 경유 대체도입 전기버스)이 없습니다.

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 13:54:49,462 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '05_co2_reduction_calc.py' finished successfully.
2025-08-22 13:54:49,462 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 13:54:49,462 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 03_display_baseline.py
2025-08-22 13:54:49,462 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 13:54:50,065 - GHGERC_BUS_PROJECT - INFO - --- Output from 03_display_baseline.py ---
--- [파일 3] 베이스라인 인자 조회 및 출력 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!

⏳ 베이스라인 인자 및 차량 마스터 데이터를 조회합니다...
⏳ 'bus_baseline_parameters' 테이블에서 데이터를 로드합니다...
✅ 0개의 'bus_baseline_parameters' 데이터를 성공적으로 로드했습니다.
⏳ 'bus_vehicle_master' 테이블에서 데이터를 로드합니다...
✅ 40개의 'bus_vehicle_master' 데이터를 성공적으로 로드했습니다.
⚠️ 조회된 데이터가 없습니다. 01, 02번 스크립트를 먼저 실행했는지 확인해주세요.

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 13:54:50,065 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '03_display_baseline.py' finished successfully.
2025-08-22 13:54:50,065 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 13:54:50,065 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 06_Report.py
2025-08-22 13:54:50,066 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 13:54:51,067 - GHGERC_BUS_PROJECT - INFO - --- Output from 06_Report.py ---
--- [파일 6] 종합 분석 보고서(Excel) 생성 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ [1/3] 종합 보고서 데이터를 로드합니다...
⏳ [2/3] 월별 운행기록 데이터를 로드합니다...
⏳ [3/3] 베이스라인 계산결과 데이터를 로드합니다...

⏳ 생성된 보고서를 Excel 파일로 저장합니다: reports\bus_analysis_report_20250822_135450.xlsx
✅ 보고서 저장이 완료되었습니다: reports\bus_analysis_report_20250822_135450.xlsx

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 13:54:51,067 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '06_Report.py' finished successfully.
2025-08-22 13:54:51,067 - GHGERC_BUS_PROJECT - INFO - 🎉🎉🎉 All scripts executed successfully! Pipeline finished. 🎉🎉🎉
2025-08-22 21:52:55,608 - GHGERC_BUS_PROJECT - INFO - ===== 🚌 Bus CO2 Reduction Calculation Pipeline Start =====
2025-08-22 21:52:57,089 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:52:57,090 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 00_edit_db.py
2025-08-22 21:52:57,090 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:52:59,657 - GHGERC_BUS_PROJECT - INFO - --- Output from 00_edit_db.py ---
--- [파일 00] 데이터베이스 스키마 관리 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!

--- 기존 테이블 삭제 및 새 테이블 생성 시작 ---
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 'bus_vehicle_master' 테이블 생성 성공적으로 실행되었습니다.
✅ 'bus_driving_records' 테이블 생성 성공적으로 실행되었습니다.
✅ 'bus_baseline_parameters' 테이블 생성 성공적으로 실행되었습니다.
✅ 'bus_emission_reductions' 테이블 생성 성공적으로 실행되었습니다.
--- 기존 테이블 삭제 및 새 테이블 생성 완료 ---

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 21:52:59,658 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '00_edit_db.py' finished successfully.
2025-08-22 21:52:59,658 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:52:59,659 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 01_insert_monthly_data.py
2025-08-22 21:52:59,659 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:53:01,890 - GHGERC_BUS_PROJECT - INFO - --- Output from 01_insert_monthly_data.py ---
--- [파일 1] 월별 운행 기록 데이터 생성 및 DB 적재 시작 ---
✅ 가상 데이터 생성 및 정제를 완료했습니다.
✅ 생성된 데이터를 엑셀 파일로 저장했습니다: generated_data\generated_bus_data_20250822_215300.xlsx
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ 'bus_vehicle_master' 테이블에 차량 마스터 데이터를 저장/업데이트합니다...
✅ 40개의 차량 마스터 레코드가 성공적으로 저장/업데이트되었습니다.
⏳ 'bus_driving_records' 테이블에 월별 데이터를 저장/업데이트합니다...
✅ 13개의 월별 운행 기록 레코드가 성공적으로 저장/업데이트되었습니다.
⏳ 'bus_monthly_fuel_data' 테이블에 월별 연료 데이터를 저장/업데이트합니다...
❌ 월별 연료 기록 데이터 저장 오류: relation "bus_monthly_fuel_data" does not exist
LINE 2:         INSERT INTO bus_monthly_fuel_data ("vehicle_plate_no...
                            ^


✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 21:53:01,890 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '01_insert_monthly_data.py' finished successfully.
2025-08-22 21:53:01,890 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:53:01,890 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 02_calculate_baseline.py
2025-08-22 21:53:01,890 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:53:02,598 - GHGERC_BUS_PROJECT - INFO - --- Output from 02_calculate_baseline.py ---
--- [파일 2] 베이스라인 인자 계산 및 DB 적재 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ 'bus_monthly_fuel_data' 테이블에서 데이터를 로드합니다...
❌ 'bus_monthly_fuel_data' 데이터 로드 중 오류 발생: Execution failed on sql 'SELECT * FROM bus_monthly_fuel_data;': relation "bus_monthly_fuel_data" does not exist
LINE 1: SELECT * FROM bus_monthly_fuel_data;
                      ^

⏳ 'bus_vehicle_master' 테이블에서 데이터를 로드합니다...
✅ 40개의 'bus_vehicle_master' 데이터를 성공적으로 로드했습니다.
⚠️ 필요한 데이터(월별 연료 기록 또는 차량 마스터)가 없습니다. 01번 스크립트를 먼저 실행해주세요.
2025-08-22 21:53:02,599 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '02_calculate_baseline.py' finished successfully.
2025-08-22 21:53:02,599 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:53:02,599 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 04_calculate_business_target.py
2025-08-22 21:53:02,599 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:53:03,205 - GHGERC_BUS_PROJECT - INFO - --- Output from 04_calculate_business_target.py ---
--- [파일 4] 사업 목표 감축량 계산 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ 	'bus_baseline_parameters' 테이블에서 데이터를 로드합니다...
✅ 0개의 	'bus_baseline_parameters' 데이터를 성공적으로 로드했습니다.
⏳ 	'bus_vehicle_master' 테이블에서 데이터를 로드합니다...
✅ 40개의 	'bus_vehicle_master' 데이터를 성공적으로 로드했습니다.
⚠️ 필요한 데이터(베이스라인 또는 차량 마스터)가 없습니다. 01, 02번 스크립트를 먼저 실행해주세요.
2025-08-22 21:53:03,206 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '04_calculate_business_target.py' finished successfully.
2025-08-22 21:53:03,206 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:53:03,206 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 05_co2_reduction_calc.py
2025-08-22 21:53:03,206 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:53:03,813 - GHGERC_BUS_PROJECT - INFO - --- Output from 05_co2_reduction_calc.py ---
--- [파일 5] 상세 CO2 감축량 계산 시작 (엑셀 로직 기반) ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ 감축량 계산을 위해 'bus_baseline_parameters'와 'bus_vehicle_master' 테이블에서 데이터를 로드합니다...
❌ 데이터 로드 중 오류 발생: Execution failed on sql '
        SELECT
            vm.vehicle_plate_no,
            vm.business_type,
            vm.ev_registration_date,
            vm.original_fuel_type,
            bp.avg_annual_fuel_l, -- 베이스라인 연간 연료 소비량
            
            bmfd.distance_km AS ev_latest_month_distance_km -- 전기차의 최신 월별 주행 거리
        FROM
            bus_vehicle_master vm
        JOIN
            bus_baseline_parameters bp ON vm.original_ice_plate_no = bp.vehicle_plate_no -- 대체된 내연기관 차량의 베이스라인 조인
        LEFT JOIN LATERAL (
            SELECT
                bmfd_sub.distance_km,
                bmfd_sub.record_year_month
            FROM
                bus_monthly_fuel_data bmfd_sub
            WHERE
                bmfd_sub.vehicle_plate_no = vm.vehicle_plate_no
            ORDER BY
                bmfd_sub.record_year_month DESC
            LIMIT 1
        ) AS bmfd ON vm.vehicle_plate_no IS NOT NULL -- 전기차량에 대해서만 조인 시도
        WHERE
            vm.ev_registration_date IS NOT NULL
            AND vm.business_type = '대체도입';
        ': relation "bus_monthly_fuel_data" does not exist
LINE 19:                 bus_monthly_fuel_data bmfd_sub
                         ^


✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 21:53:03,813 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '05_co2_reduction_calc.py' finished successfully.
2025-08-22 21:53:03,813 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:53:03,814 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 03_display_baseline.py
2025-08-22 21:53:03,814 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:53:04,447 - GHGERC_BUS_PROJECT - INFO - --- Output from 03_display_baseline.py ---
--- [파일 3] 베이스라인 인자 조회 및 출력 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!

⏳ 베이스라인 인자 및 차량 마스터 데이터를 조회합니다...
⏳ 'bus_baseline_parameters' 테이블에서 데이터를 로드합니다...
✅ 0개의 'bus_baseline_parameters' 데이터를 성공적으로 로드했습니다.
⏳ 'bus_vehicle_master' 테이블에서 데이터를 로드합니다...
✅ 40개의 'bus_vehicle_master' 데이터를 성공적으로 로드했습니다.
⚠️ 조회된 데이터가 없습니다. 01, 02번 스크립트를 먼저 실행했는지 확인해주세요.

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 21:53:04,448 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '03_display_baseline.py' finished successfully.
2025-08-22 21:53:04,448 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:53:04,448 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 06_Report.py
2025-08-22 21:53:04,448 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:53:05,442 - GHGERC_BUS_PROJECT - INFO - --- Output from 06_Report.py ---
--- [파일 6] 종합 분석 보고서(Excel) 생성 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ [1/3] 종합 보고서 데이터를 로드합니다...
⏳ [2/3] 월별 운행기록 데이터를 로드합니다...
⏳ [3/3] 베이스라인 계산결과 데이터를 로드합니다...

⏳ 생성된 보고서를 Excel 파일로 저장합니다: reports\bus_analysis_report_20250822_215305.xlsx
✅ 보고서 저장이 완료되었습니다: reports\bus_analysis_report_20250822_215305.xlsx

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 21:53:05,442 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '06_Report.py' finished successfully.
2025-08-22 21:53:05,443 - GHGERC_BUS_PROJECT - INFO - 🎉🎉🎉 All scripts executed successfully! Pipeline finished. 🎉🎉🎉
2025-08-22 21:56:02,192 - GHGERC_BUS_PROJECT - INFO - ===== 🚌 Bus CO2 Reduction Calculation Pipeline Start =====
2025-08-22 21:56:04,155 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:56:04,155 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 00_edit_db.py
2025-08-22 21:56:04,156 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:56:06,490 - GHGERC_BUS_PROJECT - INFO - --- Output from 00_edit_db.py ---
--- [파일 00] 데이터베이스 스키마 관리 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!

--- 기존 테이블 삭제 및 새 테이블 생성 시작 ---
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 'bus_vehicle_master' 테이블 생성 성공적으로 실행되었습니다.
✅ 'bus_driving_records' 테이블 생성 성공적으로 실행되었습니다.
✅ 'bus_baseline_parameters' 테이블 생성 성공적으로 실행되었습니다.
✅ 'bus_emission_reductions' 테이블 생성 성공적으로 실행되었습니다.
--- 기존 테이블 삭제 및 새 테이블 생성 완료 ---

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 21:56:06,491 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '00_edit_db.py' finished successfully.
2025-08-22 21:56:06,491 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:56:06,492 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 01_insert_monthly_data.py
2025-08-22 21:56:06,492 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:56:08,162 - GHGERC_BUS_PROJECT - INFO - --- Output from 01_insert_monthly_data.py ---
--- [파일 1] 월별 운행 기록 데이터 생성 및 DB 적재 시작 ---
✅ 가상 데이터 생성 및 정제를 완료했습니다.
✅ 생성된 데이터를 엑셀 파일로 저장했습니다: generated_data\generated_bus_data_20250822_215607.xlsx
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ 'bus_vehicle_master' 테이블에 차량 마스터 데이터를 저장/업데이트합니다...
✅ 40개의 차량 마스터 레코드가 성공적으로 저장/업데이트되었습니다.
⏳ 'bus_driving_records' 테이블에 월별 데이터를 저장/업데이트합니다...
✅ 7개의 월별 운행 기록 레코드가 성공적으로 저장/업데이트되었습니다.
⏳ 'bus_monthly_fuel_data' 테이블에 월별 연료 데이터를 저장/업데이트합니다...
❌ 월별 연료 기록 데이터 저장 오류: relation "bus_monthly_fuel_data" does not exist
LINE 2:         INSERT INTO bus_monthly_fuel_data ("vehicle_plate_no...
                            ^


✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 21:56:08,163 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '01_insert_monthly_data.py' finished successfully.
2025-08-22 21:56:08,163 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:56:08,163 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 02_calculate_baseline.py
2025-08-22 21:56:08,163 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:56:08,751 - GHGERC_BUS_PROJECT - INFO - --- Output from 02_calculate_baseline.py ---
--- [파일 2] 베이스라인 인자 계산 및 DB 적재 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ 'bus_monthly_fuel_data' 테이블에서 데이터를 로드합니다...
❌ 'bus_monthly_fuel_data' 데이터 로드 중 오류 발생: Execution failed on sql 'SELECT * FROM bus_monthly_fuel_data;': relation "bus_monthly_fuel_data" does not exist
LINE 1: SELECT * FROM bus_monthly_fuel_data;
                      ^

⏳ 'bus_vehicle_master' 테이블에서 데이터를 로드합니다...
✅ 40개의 'bus_vehicle_master' 데이터를 성공적으로 로드했습니다.
⚠️ 필요한 데이터(월별 연료 기록 또는 차량 마스터)가 없습니다. 01번 스크립트를 먼저 실행해주세요.
2025-08-22 21:56:08,751 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '02_calculate_baseline.py' finished successfully.
2025-08-22 21:56:08,751 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:56:08,751 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 04_calculate_business_target.py
2025-08-22 21:56:08,752 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:56:09,349 - GHGERC_BUS_PROJECT - INFO - --- Output from 04_calculate_business_target.py ---
--- [파일 4] 사업 목표 감축량 계산 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ 	'bus_baseline_parameters' 테이블에서 데이터를 로드합니다...
✅ 0개의 	'bus_baseline_parameters' 데이터를 성공적으로 로드했습니다.
⏳ 	'bus_vehicle_master' 테이블에서 데이터를 로드합니다...
✅ 40개의 	'bus_vehicle_master' 데이터를 성공적으로 로드했습니다.
⚠️ 필요한 데이터(베이스라인 또는 차량 마스터)가 없습니다. 01, 02번 스크립트를 먼저 실행해주세요.
2025-08-22 21:56:09,350 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '04_calculate_business_target.py' finished successfully.
2025-08-22 21:56:09,350 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:56:09,350 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 05_co2_reduction_calc.py
2025-08-22 21:56:09,350 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:56:09,940 - GHGERC_BUS_PROJECT - INFO - --- Output from 05_co2_reduction_calc.py ---
--- [파일 5] 상세 CO2 감축량 계산 시작 (엑셀 로직 기반) ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ 감축량 계산을 위해 'bus_baseline_parameters'와 'bus_vehicle_master' 테이블에서 데이터를 로드합니다...
❌ 데이터 로드 중 오류 발생: Execution failed on sql '
        SELECT
            vm.vehicle_plate_no,
            vm.business_type,
            vm.ev_registration_date,
            vm.original_fuel_type,
            bp.avg_annual_fuel_l, -- 베이스라인 연간 연료 소비량
            
            bmfd.distance_km AS ev_latest_month_distance_km -- 전기차의 최신 월별 주행 거리
        FROM
            bus_vehicle_master vm
        JOIN
            bus_baseline_parameters bp ON vm.original_ice_plate_no = bp.vehicle_plate_no -- 대체된 내연기관 차량의 베이스라인 조인
        LEFT JOIN LATERAL (
            SELECT
                bmfd_sub.distance_km,
                bmfd_sub.record_year_month
            FROM
                bus_monthly_fuel_data bmfd_sub
            WHERE
                bmfd_sub.vehicle_plate_no = vm.vehicle_plate_no
            ORDER BY
                bmfd_sub.record_year_month DESC
            LIMIT 1
        ) AS bmfd ON vm.vehicle_plate_no IS NOT NULL -- 전기차량에 대해서만 조인 시도
        WHERE
            vm.ev_registration_date IS NOT NULL
            AND vm.business_type = '대체도입';
        ': relation "bus_monthly_fuel_data" does not exist
LINE 19:                 bus_monthly_fuel_data bmfd_sub
                         ^


✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 21:56:09,940 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '05_co2_reduction_calc.py' finished successfully.
2025-08-22 21:56:09,941 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:56:09,941 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 03_display_baseline.py
2025-08-22 21:56:09,941 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:56:10,529 - GHGERC_BUS_PROJECT - INFO - --- Output from 03_display_baseline.py ---
--- [파일 3] 베이스라인 인자 조회 및 출력 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!

⏳ 베이스라인 인자 및 차량 마스터 데이터를 조회합니다...
⏳ 'bus_baseline_parameters' 테이블에서 데이터를 로드합니다...
✅ 0개의 'bus_baseline_parameters' 데이터를 성공적으로 로드했습니다.
⏳ 'bus_vehicle_master' 테이블에서 데이터를 로드합니다...
✅ 40개의 'bus_vehicle_master' 데이터를 성공적으로 로드했습니다.
⚠️ 조회된 데이터가 없습니다. 01, 02번 스크립트를 먼저 실행했는지 확인해주세요.

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 21:56:10,529 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '03_display_baseline.py' finished successfully.
2025-08-22 21:56:10,529 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:56:10,529 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 06_Report.py
2025-08-22 21:56:10,529 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:56:11,480 - GHGERC_BUS_PROJECT - INFO - --- Output from 06_Report.py ---
--- [파일 6] 종합 분석 보고서(Excel) 생성 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ [1/3] 종합 보고서 데이터를 로드합니다...
⏳ [2/3] 월별 운행기록 데이터를 로드합니다...
⏳ [3/3] 베이스라인 계산결과 데이터를 로드합니다...

⏳ 생성된 보고서를 Excel 파일로 저장합니다: reports\bus_analysis_report_20250822_215611.xlsx
✅ 보고서 저장이 완료되었습니다: reports\bus_analysis_report_20250822_215611.xlsx

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 21:56:11,481 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '06_Report.py' finished successfully.
2025-08-22 21:56:11,481 - GHGERC_BUS_PROJECT - INFO - 🎉🎉🎉 All scripts executed successfully! Pipeline finished. 🎉🎉🎉
2025-08-22 21:57:41,564 - GHGERC_BUS_PROJECT - INFO - ===== 🚌 Bus CO2 Reduction Calculation Pipeline Start =====
2025-08-22 21:57:43,230 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:57:43,231 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 00_edit_db.py
2025-08-22 21:57:43,231 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:57:45,557 - GHGERC_BUS_PROJECT - INFO - --- Output from 00_edit_db.py ---
--- [파일 00] 데이터베이스 스키마 관리 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!

--- 기존 테이블 삭제 및 새 테이블 생성 시작 ---
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 'bus_vehicle_master' 테이블 생성 성공적으로 실행되었습니다.
✅ 'bus_driving_records' 테이블 생성 성공적으로 실행되었습니다.
✅ 'bus_baseline_parameters' 테이블 생성 성공적으로 실행되었습니다.
✅ 'bus_emission_reductions' 테이블 생성 성공적으로 실행되었습니다.
--- 기존 테이블 삭제 및 새 테이블 생성 완료 ---

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 21:57:45,557 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '00_edit_db.py' finished successfully.
2025-08-22 21:57:45,557 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:57:45,558 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 01_insert_monthly_data.py
2025-08-22 21:57:45,558 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:57:47,268 - GHGERC_BUS_PROJECT - INFO - --- Output from 01_insert_monthly_data.py ---
--- [파일 1] 월별 운행 기록 데이터 생성 및 DB 적재 시작 ---
✅ 가상 데이터 생성 및 정제를 완료했습니다.
✅ 생성된 데이터를 엑셀 파일로 저장했습니다: generated_data\generated_bus_data_20250822_215746.xlsx
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ 'bus_vehicle_master' 테이블에 차량 마스터 데이터를 저장/업데이트합니다...
✅ 40개의 차량 마스터 레코드가 성공적으로 저장/업데이트되었습니다.
⏳ 'bus_driving_records' 테이블에 월별 데이터를 저장/업데이트합니다...
✅ 16개의 월별 운행 기록 레코드가 성공적으로 저장/업데이트되었습니다.
⏳ 'bus_monthly_fuel_data' 테이블에 월별 연료 데이터를 저장/업데이트합니다...
❌ 월별 연료 기록 데이터 저장 오류: relation "bus_monthly_fuel_data" does not exist
LINE 2:         INSERT INTO bus_monthly_fuel_data ("vehicle_plate_no...
                            ^


✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 21:57:47,268 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '01_insert_monthly_data.py' finished successfully.
2025-08-22 21:57:47,268 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:57:47,268 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 02_calculate_baseline.py
2025-08-22 21:57:47,268 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:57:47,861 - GHGERC_BUS_PROJECT - INFO - --- Output from 02_calculate_baseline.py ---
--- [파일 2] 베이스라인 인자 계산 및 DB 적재 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ 'bus_monthly_fuel_data' 테이블에서 데이터를 로드합니다...
❌ 'bus_monthly_fuel_data' 데이터 로드 중 오류 발생: Execution failed on sql 'SELECT * FROM bus_monthly_fuel_data;': relation "bus_monthly_fuel_data" does not exist
LINE 1: SELECT * FROM bus_monthly_fuel_data;
                      ^

⏳ 'bus_vehicle_master' 테이블에서 데이터를 로드합니다...
✅ 40개의 'bus_vehicle_master' 데이터를 성공적으로 로드했습니다.
⚠️ 필요한 데이터(월별 연료 기록 또는 차량 마스터)가 없습니다. 01번 스크립트를 먼저 실행해주세요.
2025-08-22 21:57:47,861 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '02_calculate_baseline.py' finished successfully.
2025-08-22 21:57:47,861 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:57:47,861 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 04_calculate_business_target.py
2025-08-22 21:57:47,862 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:57:48,511 - GHGERC_BUS_PROJECT - INFO - --- Output from 04_calculate_business_target.py ---
--- [파일 4] 사업 목표 감축량 계산 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ 	'bus_baseline_parameters' 테이블에서 데이터를 로드합니다...
✅ 0개의 	'bus_baseline_parameters' 데이터를 성공적으로 로드했습니다.
⏳ 	'bus_vehicle_master' 테이블에서 데이터를 로드합니다...
✅ 40개의 	'bus_vehicle_master' 데이터를 성공적으로 로드했습니다.
⚠️ 필요한 데이터(베이스라인 또는 차량 마스터)가 없습니다. 01, 02번 스크립트를 먼저 실행해주세요.
2025-08-22 21:57:48,511 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '04_calculate_business_target.py' finished successfully.
2025-08-22 21:57:48,511 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:57:48,511 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 05_co2_reduction_calc.py
2025-08-22 21:57:48,512 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:57:49,078 - GHGERC_BUS_PROJECT - INFO - --- Output from 05_co2_reduction_calc.py ---
--- [파일 5] 상세 CO2 감축량 계산 시작 (엑셀 로직 기반) ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ 감축량 계산을 위해 'bus_baseline_parameters'와 'bus_vehicle_master' 테이블에서 데이터를 로드합니다...
❌ 데이터 로드 중 오류 발생: Execution failed on sql '
        SELECT
            vm.vehicle_plate_no,
            vm.business_type,
            vm.ev_registration_date,
            vm.original_fuel_type,
            bp.avg_annual_fuel_l, -- 베이스라인 연간 연료 소비량
            
            bmfd.distance_km AS ev_latest_month_distance_km -- 전기차의 최신 월별 주행 거리
        FROM
            bus_vehicle_master vm
        JOIN
            bus_baseline_parameters bp ON vm.original_ice_plate_no = bp.vehicle_plate_no -- 대체된 내연기관 차량의 베이스라인 조인
        LEFT JOIN LATERAL (
            SELECT
                bmfd_sub.distance_km,
                bmfd_sub.record_year_month
            FROM
                bus_monthly_fuel_data bmfd_sub
            WHERE
                bmfd_sub.vehicle_plate_no = vm.vehicle_plate_no
            ORDER BY
                bmfd_sub.record_year_month DESC
            LIMIT 1
        ) AS bmfd ON vm.vehicle_plate_no IS NOT NULL -- 전기차량에 대해서만 조인 시도
        WHERE
            vm.ev_registration_date IS NOT NULL
            AND vm.business_type = '대체도입';
        ': relation "bus_monthly_fuel_data" does not exist
LINE 19:                 bus_monthly_fuel_data bmfd_sub
                         ^


✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 21:57:49,078 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '05_co2_reduction_calc.py' finished successfully.
2025-08-22 21:57:49,079 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:57:49,079 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 03_display_baseline.py
2025-08-22 21:57:49,079 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:57:49,644 - GHGERC_BUS_PROJECT - INFO - --- Output from 03_display_baseline.py ---
--- [파일 3] 베이스라인 인자 조회 및 출력 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!

⏳ 베이스라인 인자 및 차량 마스터 데이터를 조회합니다...
⏳ 'bus_baseline_parameters' 테이블에서 데이터를 로드합니다...
✅ 0개의 'bus_baseline_parameters' 데이터를 성공적으로 로드했습니다.
⏳ 'bus_vehicle_master' 테이블에서 데이터를 로드합니다...
✅ 40개의 'bus_vehicle_master' 데이터를 성공적으로 로드했습니다.
⚠️ 조회된 데이터가 없습니다. 01, 02번 스크립트를 먼저 실행했는지 확인해주세요.

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 21:57:49,644 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '03_display_baseline.py' finished successfully.
2025-08-22 21:57:49,644 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:57:49,645 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 06_Report.py
2025-08-22 21:57:49,645 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:57:50,568 - GHGERC_BUS_PROJECT - INFO - --- Output from 06_Report.py ---
--- [파일 6] 종합 분석 보고서(Excel) 생성 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ [1/3] 종합 보고서 데이터를 로드합니다...
⏳ [2/3] 월별 운행기록 데이터를 로드합니다...
⏳ [3/3] 베이스라인 계산결과 데이터를 로드합니다...

⏳ 생성된 보고서를 Excel 파일로 저장합니다: reports\bus_analysis_report_20250822_215750.xlsx
✅ 보고서 저장이 완료되었습니다: reports\bus_analysis_report_20250822_215750.xlsx

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 21:57:50,568 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '06_Report.py' finished successfully.
2025-08-22 21:57:50,568 - GHGERC_BUS_PROJECT - INFO - 🎉🎉🎉 All scripts executed successfully! Pipeline finished. 🎉🎉🎉
2025-08-22 21:58:47,641 - GHGERC_BUS_PROJECT - INFO - ===== 🚌 Bus CO2 Reduction Calculation Pipeline Start =====
2025-08-22 21:58:49,116 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:58:49,117 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 00_edit_db.py
2025-08-22 21:58:49,117 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:58:51,710 - GHGERC_BUS_PROJECT - INFO - --- Output from 00_edit_db.py ---
--- [파일 00] 데이터베이스 스키마 관리 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!

--- 기존 테이블 삭제 및 새 테이블 생성 시작 ---
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 'bus_vehicle_master' 테이블 생성 성공적으로 실행되었습니다.
✅ 'bus_driving_records' 테이블 생성 성공적으로 실행되었습니다.
✅ 'bus_monthly_fuel_data' 테이블 생성 성공적으로 실행되었습니다.
✅ 'bus_baseline_parameters' 테이블 생성 성공적으로 실행되었습니다.
✅ 'bus_emission_reductions' 테이블 생성 성공적으로 실행되었습니다.
--- 기존 테이블 삭제 및 새 테이블 생성 완료 ---

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 21:58:51,711 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '00_edit_db.py' finished successfully.
2025-08-22 21:58:51,711 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:58:51,712 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 01_insert_monthly_data.py
2025-08-22 21:58:51,712 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:58:53,836 - GHGERC_BUS_PROJECT - INFO - --- Output from 01_insert_monthly_data.py ---
--- [파일 1] 월별 운행 기록 데이터 생성 및 DB 적재 시작 ---
✅ 가상 데이터 생성 및 정제를 완료했습니다.
✅ 생성된 데이터를 엑셀 파일로 저장했습니다: generated_data\generated_bus_data_20250822_215852.xlsx
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ 'bus_vehicle_master' 테이블에 차량 마스터 데이터를 저장/업데이트합니다...
✅ 40개의 차량 마스터 레코드가 성공적으로 저장/업데이트되었습니다.
⏳ 'bus_driving_records' 테이블에 월별 데이터를 저장/업데이트합니다...
✅ 50개의 월별 운행 기록 레코드가 성공적으로 저장/업데이트되었습니다.
⏳ 'bus_monthly_fuel_data' 테이블에 월별 연료 데이터를 저장/업데이트합니다...
✅ 50개의 월별 연료 기록 레코드가 성공적으로 삽입/업데이트되었습니다.

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 21:58:53,836 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '01_insert_monthly_data.py' finished successfully.
2025-08-22 21:58:53,836 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:58:53,836 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 02_calculate_baseline.py
2025-08-22 21:58:53,836 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:58:54,637 - GHGERC_BUS_PROJECT - INFO - --- Output from 02_calculate_baseline.py ---
--- [파일 2] 베이스라인 인자 계산 및 DB 적재 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ 'bus_monthly_fuel_data' 테이블에서 데이터를 로드합니다...
✅ 1450개의 'bus_monthly_fuel_data' 데이터를 성공적으로 로드했습니다.
⏳ 'bus_vehicle_master' 테이블에서 데이터를 로드합니다...
✅ 40개의 'bus_vehicle_master' 데이터를 성공적으로 로드했습니다.
✅ 베이스라인 계산 대상 내연기관 차량 33대에 대한 데이터 1395개를 로드했습니다.
⚠️ 차량 서울74사1074: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사1846: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사2508: 베이스라인 계산에 필요한 최소 3년(36개월)치 데이터가 부족합니다 (35개월). 베이스라인을 계산하지 않습니다.
⚠️ 차량 서울74사2545: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사3611: 베이스라인 계산에 필요한 최소 3년(36개월)치 데이터가 부족합니다 (34개월). 베이스라인을 계산하지 않습니다.
⚠️ 차량 서울74사4283: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사4376: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사5908: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사6686: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사7565: 베이스라인 계산에 필요한 최소 3년(36개월)치 데이터가 부족합니다 (33개월). 베이스라인을 계산하지 않습니다.
⚠️ 차량 서울74사8321: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사8499: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사9636: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
✅ 베이스라인 인자 계산을 완료했습니다.
⏳ 'bus_baseline_parameters' 테이블에 데이터를 저장/업데이트합니다...
❌ 베이스라인 데이터 저장 오류: column "baseline_co2_emission_kg" of relation "bus_baseline_parameters" does not exist
LINE 2: ...distance_km", "avg_annual_fuel_l", "fuel_per_km", "baseline_...
                                                             ^


✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 21:58:54,638 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '02_calculate_baseline.py' finished successfully.
2025-08-22 21:58:54,638 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:58:54,638 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 04_calculate_business_target.py
2025-08-22 21:58:54,638 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:58:55,254 - GHGERC_BUS_PROJECT - INFO - --- Output from 04_calculate_business_target.py ---
--- [파일 4] 사업 목표 감축량 계산 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ 	'bus_baseline_parameters' 테이블에서 데이터를 로드합니다...
✅ 0개의 	'bus_baseline_parameters' 데이터를 성공적으로 로드했습니다.
⏳ 	'bus_vehicle_master' 테이블에서 데이터를 로드합니다...
✅ 40개의 	'bus_vehicle_master' 데이터를 성공적으로 로드했습니다.
⚠️ 필요한 데이터(베이스라인 또는 차량 마스터)가 없습니다. 01, 02번 스크립트를 먼저 실행해주세요.
2025-08-22 21:58:55,254 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '04_calculate_business_target.py' finished successfully.
2025-08-22 21:58:55,254 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:58:55,254 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 05_co2_reduction_calc.py
2025-08-22 21:58:55,255 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:58:55,869 - GHGERC_BUS_PROJECT - INFO - --- Output from 05_co2_reduction_calc.py ---
--- [파일 5] 상세 CO2 감축량 계산 시작 (엑셀 로직 기반) ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ 감축량 계산을 위해 'bus_baseline_parameters'와 'bus_vehicle_master' 테이블에서 데이터를 로드합니다...
⚠️ 상세 감축량 계산 대상(CNG, 경유 대체도입 전기버스)이 없습니다.

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 21:58:55,869 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '05_co2_reduction_calc.py' finished successfully.
2025-08-22 21:58:55,869 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:58:55,869 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 03_display_baseline.py
2025-08-22 21:58:55,870 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:58:56,476 - GHGERC_BUS_PROJECT - INFO - --- Output from 03_display_baseline.py ---
--- [파일 3] 베이스라인 인자 조회 및 출력 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!

⏳ 베이스라인 인자 및 차량 마스터 데이터를 조회합니다...
⏳ 'bus_baseline_parameters' 테이블에서 데이터를 로드합니다...
✅ 0개의 'bus_baseline_parameters' 데이터를 성공적으로 로드했습니다.
⏳ 'bus_vehicle_master' 테이블에서 데이터를 로드합니다...
✅ 40개의 'bus_vehicle_master' 데이터를 성공적으로 로드했습니다.
⚠️ 조회된 데이터가 없습니다. 01, 02번 스크립트를 먼저 실행했는지 확인해주세요.

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 21:58:56,476 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '03_display_baseline.py' finished successfully.
2025-08-22 21:58:56,476 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:58:56,477 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 06_Report.py
2025-08-22 21:58:56,477 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 21:58:57,480 - GHGERC_BUS_PROJECT - INFO - --- Output from 06_Report.py ---
--- [파일 6] 종합 분석 보고서(Excel) 생성 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ [1/3] 종합 보고서 데이터를 로드합니다...
⏳ [2/3] 월별 운행기록 데이터를 로드합니다...
⏳ [3/3] 베이스라인 계산결과 데이터를 로드합니다...

⏳ 생성된 보고서를 Excel 파일로 저장합니다: reports\bus_analysis_report_20250822_215857.xlsx
✅ 보고서 저장이 완료되었습니다: reports\bus_analysis_report_20250822_215857.xlsx

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 21:58:57,481 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '06_Report.py' finished successfully.
2025-08-22 21:58:57,481 - GHGERC_BUS_PROJECT - INFO - 🎉🎉🎉 All scripts executed successfully! Pipeline finished. 🎉🎉🎉
2025-08-22 22:00:17,486 - GHGERC_BUS_PROJECT - INFO - ===== 🚌 Bus CO2 Reduction Calculation Pipeline Start =====
2025-08-22 22:00:19,144 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 22:00:19,144 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 00_edit_db.py
2025-08-22 22:00:19,145 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 22:00:21,965 - GHGERC_BUS_PROJECT - INFO - --- Output from 00_edit_db.py ---
--- [파일 00] 데이터베이스 스키마 관리 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!

--- 기존 테이블 삭제 및 새 테이블 생성 시작 ---
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 테이블 삭제: EXISTS 성공적으로 실행되었습니다.
✅ 'bus_vehicle_master' 테이블 생성 성공적으로 실행되었습니다.
✅ 'bus_driving_records' 테이블 생성 성공적으로 실행되었습니다.
✅ 'bus_monthly_fuel_data' 테이블 생성 성공적으로 실행되었습니다.
✅ 'bus_baseline_parameters' 테이블 생성 성공적으로 실행되었습니다.
✅ 'bus_emission_reductions' 테이블 생성 성공적으로 실행되었습니다.
--- 기존 테이블 삭제 및 새 테이블 생성 완료 ---

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 22:00:21,965 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '00_edit_db.py' finished successfully.
2025-08-22 22:00:21,966 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 22:00:21,966 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 01_insert_monthly_data.py
2025-08-22 22:00:21,966 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 22:00:24,246 - GHGERC_BUS_PROJECT - INFO - --- Output from 01_insert_monthly_data.py ---
--- [파일 1] 월별 운행 기록 데이터 생성 및 DB 적재 시작 ---
✅ 가상 데이터 생성 및 정제를 완료했습니다.
✅ 생성된 데이터를 엑셀 파일로 저장했습니다: generated_data\generated_bus_data_20250822_220022.xlsx
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ 'bus_vehicle_master' 테이블에 차량 마스터 데이터를 저장/업데이트합니다...
✅ 40개의 차량 마스터 레코드가 성공적으로 저장/업데이트되었습니다.
⏳ 'bus_driving_records' 테이블에 월별 데이터를 저장/업데이트합니다...
✅ 80개의 월별 운행 기록 레코드가 성공적으로 저장/업데이트되었습니다.
⏳ 'bus_monthly_fuel_data' 테이블에 월별 연료 데이터를 저장/업데이트합니다...
✅ 80개의 월별 연료 기록 레코드가 성공적으로 삽입/업데이트되었습니다.

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 22:00:24,247 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '01_insert_monthly_data.py' finished successfully.
2025-08-22 22:00:24,247 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 22:00:24,247 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 02_calculate_baseline.py
2025-08-22 22:00:24,248 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 22:00:25,156 - GHGERC_BUS_PROJECT - INFO - --- Output from 02_calculate_baseline.py ---
--- [파일 2] 베이스라인 인자 계산 및 DB 적재 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ 'bus_monthly_fuel_data' 테이블에서 데이터를 로드합니다...
✅ 1280개의 'bus_monthly_fuel_data' 데이터를 성공적으로 로드했습니다.
⏳ 'bus_vehicle_master' 테이블에서 데이터를 로드합니다...
✅ 40개의 'bus_vehicle_master' 데이터를 성공적으로 로드했습니다.
✅ 베이스라인 계산 대상 내연기관 차량 29대에 대한 데이터 1176개를 로드했습니다.
⚠️ 차량 서울74사1007: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사1854: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사2421: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사2447: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사2630: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사3736: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사4812: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사5166: 베이스라인 계산에 필요한 최소 3년(36개월)치 데이터가 부족합니다 (35개월). 베이스라인을 계산하지 않습니다.
⚠️ 차량 서울74사5856: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사7204: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
⚠️ 차량 서울74사7299: 유효한 월별 연료/거리 데이터가 없어 베이스라인을 계산할 수 없습니다.
✅ 베이스라인 인자 계산을 완료했습니다.
⏳ 'bus_baseline_parameters' 테이블에 데이터를 저장/업데이트합니다...
✅ 18개의 베이스라인 레코드가 성공적으로 저장/업데이트되었습니다.

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 22:00:25,156 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '02_calculate_baseline.py' finished successfully.
2025-08-22 22:00:25,157 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 22:00:25,157 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 04_calculate_business_target.py
2025-08-22 22:00:25,157 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 22:00:25,890 - GHGERC_BUS_PROJECT - INFO - --- Output from 04_calculate_business_target.py ---
--- [파일 4] 사업 목표 감축량 계산 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ 	'bus_baseline_parameters' 테이블에서 데이터를 로드합니다...
✅ 18개의 	'bus_baseline_parameters' 데이터를 성공적으로 로드했습니다.
⏳ 	'bus_vehicle_master' 테이블에서 데이터를 로드합니다...
✅ 40개의 	'bus_vehicle_master' 데이터를 성공적으로 로드했습니다.

⏳ CO2 감축량을 계산합니다...

[계산된 감축량 데이터 (상위 5개 행)]
  vehicle_plate_no  calculated_year  ...  co2_reduction_kg  reduction_category
0        서울74사2685             2025  ...               0.0                    
1        서울74사3737             2025  ...               0.0                    
2        서울74사3901             2025  ...               0.0                    
3        서울74사4034             2025  ...               0.0                    
4        서울74사5082             2025  ...               0.0                    
5        서울74사5187             2025  ...               0.0                    
6        서울74사5462             2025  ...               0.0                    
7        서울74사5549             2025  ...               0.0                    
8        서울74사6505             2025  ...               0.0                    
9        서울74사6569             2025  ...               0.0                    

[10 rows x 8 columns]
⏳ 'bus_emission_reductions' 테이블에 데이터를 저장/업데이트합니다...
✅ 18개의 감축량 레코드가 성공적으로 저장/업데이트되었습니다.

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 22:00:25,891 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '04_calculate_business_target.py' finished successfully.
2025-08-22 22:00:25,891 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 22:00:25,891 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 05_co2_reduction_calc.py
2025-08-22 22:00:25,891 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 22:00:26,791 - GHGERC_BUS_PROJECT - INFO - --- Output from 05_co2_reduction_calc.py ---
--- [파일 5] 상세 CO2 감축량 계산 시작 (엑셀 로직 기반) ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ 감축량 계산을 위해 'bus_baseline_parameters'와 'bus_vehicle_master' 테이블에서 데이터를 로드합니다...
✅ 10개의 계산 대상 차량 데이터를 성공적으로 로드했습니다.

⏳ CO2 감축량을 상세 로직에 따라 계산합니다...

ℹ️  CNG 연료량은 DB의 'L' 단위 컬럼 값을 질량(kg)으로 간주하고, 밀도를 이용해 부피(m³)로 변환하여 계산합니다.

[상세 계산된 감축량 데이터 (상위 5개 행)]
  vehicle_plate_no  calculated_year  ...  co2_reduction_kg  reduction_category
0        서울74사1854             2025  ...     105006.294741        대체버스 감축 (상세)
1        서울74사5856             2025  ...      97969.444146        대체버스 감축 (상세)
2        서울74사2447             2025  ...     100344.670201        대체버스 감축 (상세)
3        서울74사1007             2025  ...      89651.868076        대체버스 감축 (상세)
4        서울74사7299             2025  ...      88562.614111        대체버스 감축 (상세)

[5 rows x 8 columns]
⏳ 'bus_emission_reductions' 테이블에 상세 계산된 감축량 데이터를 저장/업데이트합니다...
✅ 10개의 감축량 레코드가 성공적으로 저장/업데이트되었습니다.

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 22:00:26,791 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '05_co2_reduction_calc.py' finished successfully.
2025-08-22 22:00:26,791 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 22:00:26,792 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 03_display_baseline.py
2025-08-22 22:00:26,792 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 22:00:27,577 - GHGERC_BUS_PROJECT - INFO - --- Output from 03_display_baseline.py ---
--- [파일 3] 베이스라인 인자 조회 및 출력 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!

⏳ 베이스라인 인자 및 차량 마스터 데이터를 조회합니다...
⏳ 'bus_baseline_parameters' 테이블에서 데이터를 로드합니다...
✅ 18개의 'bus_baseline_parameters' 데이터를 성공적으로 로드했습니다.
⏳ 'bus_vehicle_master' 테이블에서 데이터를 로드합니다...
✅ 40개의 'bus_vehicle_master' 데이터를 성공적으로 로드했습니다.

====================================================================================================
                                      [ 최종 베이스라인 인자 ]
====================================================================================================
         차량번호    업체명  사업구분 기존 연료  ... 산정월수 연평균주행거리(km)  연평균주유량(L)  연비(L/km)
0   서울74사2685   희망버스  내연기관    경유  ...   36   64,161.01  33,434.81      0.52
1   서울74사3737   가상교통  내연기관   CNG  ...   41   63,137.91  33,670.61      0.53
2   서울74사3901   가상교통  내연기관    경유  ...   41   63,932.55  33,514.51      0.52
3   서울74사4034  데이터교통  내연기관    경유  ...   41   65,574.50  34,705.55      0.53
4   서울74사5082  데이터교통  내연기관    경유  ...   41   66,165.73  35,102.70      0.53
5   서울74사5187   가상교통  내연기관    경유  ...   37   63,180.89  32,586.76      0.52
6   서울74사5462   가상교통  내연기관   CNG  ...   41   66,782.03  34,423.36      0.52
7   서울74사5549   미래운수  내연기관    경유  ...   36   66,174.13  33,781.34      0.51
8   서울74사6505   미래운수  내연기관   CNG  ...   36   66,170.87  34,206.17      0.52
9   서울74사6569  데이터교통  내연기관   CNG  ...   40   63,081.04  32,201.12      0.51
10  서울74사7083   희망버스  내연기관    경유  ...   41   64,903.06  33,701.16      0.52
11  서울74사7732  데이터교통  내연기관   CNG  ...   41   62,290.57  32,895.17      0.53
12  서울74사7883   가상교통  내연기관    경유  ...   36   64,625.01  34,302.03      0.53
13  서울74사7934  데이터교통  내연기관   CNG  ...   39   64,655.15  33,755.17      0.52
14  서울74사7936  데이터교통  내연기관   CNG  ...   39   62,927.40  31,444.97      0.50
15  서울74사8315   가상교통  내연기관   CNG  ...   41   63,140.07  32,158.90      0.51
16  서울74사8662   가상교통  내연기관    경유  ...   41   66,398.14  34,115.66      0.51
17  서울74사9887  데이터교통  내연기관   CNG  ...   41   61,863.48  32,116.52      0.52

[18 rows x 10 columns]
====================================================================================================
✅ 엑셀 파일 저장 성공: C:\Users\USER\OneDrive - 주식회사후시파트너스\문서\Develope\GHGERC_BUS\reports\baseline_calculation_results_20250822_220027.xlsx

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 22:00:27,578 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '03_display_baseline.py' finished successfully.
2025-08-22 22:00:27,578 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 22:00:27,578 - GHGERC_BUS_PROJECT - INFO - 🚀 Executing: 06_Report.py
2025-08-22 22:00:27,578 - GHGERC_BUS_PROJECT - INFO - ============================================================
2025-08-22 22:00:28,488 - GHGERC_BUS_PROJECT - INFO - --- Output from 06_Report.py ---
--- [파일 6] 종합 분석 보고서(Excel) 생성 시작 ---
⏳ 데이터베이스에 연결을 시도합니다...
✅ 데이터베이스 연결에 성공했습니다!
⏳ [1/3] 종합 보고서 데이터를 로드합니다...
⏳ [2/3] 월별 운행기록 데이터를 로드합니다...
⏳ [3/3] 베이스라인 계산결과 데이터를 로드합니다...

⏳ 생성된 보고서를 Excel 파일로 저장합니다: reports\bus_analysis_report_20250822_220028.xlsx
✅ 보고서 저장이 완료되었습니다: reports\bus_analysis_report_20250822_220028.xlsx

✅ 데이터베이스 연결을 닫았습니다.
2025-08-22 22:00:28,488 - GHGERC_BUS_PROJECT - INFO - ✅ Success: '06_Report.py' finished successfully.
2025-08-22 22:00:28,488 - GHGERC_BUS_PROJECT - INFO - 🎉🎉🎉 All scripts executed successfully! Pipeline finished. 🎉🎉🎉
